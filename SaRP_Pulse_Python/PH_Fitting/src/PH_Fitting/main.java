package PH_Fitting;

import java.io.IOException;
import java.util.Arrays;
import java.util.Vector;

import jphase.ContPhaseVar;
import jphase.DenseContPhaseVar;
import jphase.HyperErlangVar;
import jphase.fit.*;

public class main {
	public static void main(String[] args) throws IOException, InterruptedException {
		//ContPhaseVar v1 = DenseContPhaseVar.expo( 3 ) ;
		//ContPhaseVar v2 = DenseContPhaseVar.Erlang(1.5,2) ;
		//ContPhaseVar v3 = v1.max(v2) ;
		//System.out.println( "P( v3<=2.0):n t " + v3.cdf(2.0));
		
		//ContPhaseVar v1 = DenseContPhaseVar.Erlang(0.8 , 3 ) ;
		//ContPhaseVar v2 = DenseContPhaseVar.Erlang(1.5 ,2) ;
		//ContPhaseVar v3 = v1.sum( v2 ) ;
		
		//System.out.print("v3 : n n"+v3.toString( ) ) ;
		
		double [ ] [ ] A = new double[][] {
			{-0.00433679690753372, 0.00433679690753372, 0.0, 0.0, 0.0},
			{0.0, -0.00433679690753372,   0.00433679690753372, 0.0, 0.0},
			{0.0, 0.0, -0.00433679690753372, 0.00433679690753372, 0.0},
			{0.0, 0.0, 0.0 , -0.00433679690753372,   0.00433679690753372},
			{0.0, 0.0, 0.0, 0.0,  -0.00433679690753372}}; 
		
//		for(int i=0 ;i<A.length; i++) {
//			for(int j=0 ;j<A.length; j++) {
//				A[i][j]=
//			}
//		}
		int n = A.length-1;
		A[n][n]=(double) ((int)(A[n][n]*10000000))/10000000;
		
		
		double [ ] alpha = new double [] {1.0,0.0,0.0,0.0,0.0};
		DenseContPhaseVar v1 = new DenseContPhaseVar ( alpha , A) ;
		
		
		
		/*
		double [ ] [ ] AA = new double[][] {{0}};
		double [ ]  ttau = new double[] {0};
		ContPhaseVar ptRV=new DenseContPhaseVar(ttau, AA);
		
		double [ ] [ ] A = new double[][] {{-0.0428,0.0428,0},{0,-0.0428,0.0428},{0,0,-0.0428}};
		double [ ]  tau = new double[] {1,0,0};
		ContPhaseVar v1=new DenseContPhaseVar(tau, A);
		
		double [ ] [ ] B = new double[][] {{-0.1523,0.1523,0},{0,-0.1523,0.1523},{0,0,-0.1523}};
		double [ ] beta = new double [] {1,0,0};
		DenseContPhaseVar v2 = new DenseContPhaseVar ( beta , B) ;
		double [ ] [ ] C = new double[][] {{-0.00577156  ,0.00577156 , 0.},{0., -0.00577156 , 0.},{0.,  0.,-0.00675044} };
		*/
		
		//double [ ] delta = new double [] {0.90242943, 0.,0.09757057};
		//DenseContPhaseVar v3 = new DenseContPhaseVar ( delta , C) ;
		
		//ContPhaseVar v4 = v2.sum( v1 ).sum(v3);
		//ContPhaseVar v5 = v1.sum( v2 ).sum(v3);
		//ContPhaseVar v3=ptRV.sum(v1);
		//ContPhaseVar v4 = v3.sum( v2 );
		
		
		//System.out.println("v1:"+v1.description() );
		System.out.println("cdf1: "+v1.cdf(1221));
		//double t= System.nanoTime();
		//System.out.println("cdf1: "+v1.cdf(7700));
		//double tf= System.nanoTime();
		//System.out.println((tf-t)/1000000000);
		
		//System.out.println("pdf1: "+v1.pdf(7700));
		//System.out.println("v2:"+v2.description() );
		//System.out.println("v4:"+v4.description() );
		
		
		//System.out.println("v5:"+v5.description() );
		//System.out.println("cfd5: "+v5.cdf(300));
		//System.out.println("pdf5: "+v5.pdf(300));
		
		
		/**
		double[] data={ 1.57047035,  4.2818096 ,  5.38914739,  2.73815737,  3.82308256,
		        1.99663859,  5.24455692,  5.81839255,  4.62190509,  6.810872  ,
		        9.58628194,  8.42705898,  3.98402523,  8.3267961 ,  2.84005556,
		        3.96475535,  6.63779   ,  1.96698411,  4.58903839,  3.73510936,
		        2.52390043,  3.86873401,  3.85821121,  2.01693913,  5.67745312,
		        8.04515664,  2.98771551,  4.21074677,  6.43319517,  4.76265314,
		        4.25345984,  5.79193476,  7.08383871,  4.40706697,  5.44175754,
		        4.70553236,  4.65590954,  3.65307198,  1.54406356,  1.13390732,
		        5.27258708,  7.45355706,  4.30951312,  7.22648542,  6.07970951,
		        2.17998511,  4.8951749 ,  6.50340705,  4.54179992,  8.20115895,
		        8.80887986, 14.47709041,  3.17779648,  4.97080954,  7.51964052,
		        8.75742122,  2.23788198,  6.16202092,  3.8337619 ,  7.23206862,
		        8.37540844,  4.82981809,  6.73620966,  3.04274219,  2.44822099,
		       10.21061397,  2.7355117 , 10.00732784,  4.50525561,  3.04485429,
		        4.41277107,  5.1210127 ,  1.327415  ,  6.29800493,  6.08619717,
		        1.87021167,  5.11550243,  4.36508367,  3.76629171,  2.91401276,
		        6.15084873,  6.44767917,  4.31484481,  3.62852088,  2.31991091,
		        9.77939898,  3.13105838,  3.6548113 ,  5.47124999,  3.39927598,
		       10.11197359,  3.88162191,  3.6809183 ,  4.68258872,  2.47873774,
		        3.89548762,  1.01568173,  5.27264874,  3.25647438,  3.33019403,
		        4.6836112 ,  2.14649369,  6.71600792,  4.72737334,  5.74905367,
		        4.0400107 ,  2.55241046,  7.60748481,  3.86848729,  5.0615756 ,
		        6.93775481,  6.01302464,  3.15029957,  5.79624491,  3.18513148,
		        3.06845354,  1.25640529,  7.37179186,  4.00311167,  6.82733922,
		        6.46850803,  4.41894333,  9.55269046,  9.137255  ,  3.52105449,
		        6.00765391,  2.89490032,  6.34451219,  3.4958364 ,  4.59651432,
		        6.01665672,  4.40268531,  3.39038788,  2.86564028,  7.07194953,
		        6.67490784,  2.16709024,  4.78084165,  8.24613833,  5.44667183,
		        5.52958717,  4.26924344,  7.92442765,  4.86296712,  3.79008293,
		        3.60609537,  2.87850089,  4.26834877,  4.56973253,  6.37580292,
		        3.50924737,  2.66629547,  4.56575563,  5.72965403,  1.9413226 ,
		        5.4281586 ,  8.4305716 ,  4.43527137,  5.8797747 ,  2.54272676,
		        5.40130022,  7.12736424,  2.62566853,  2.58007568,  7.61348269,
		        9.10799531,  1.01032625,  6.37816002,  5.09404711, 14.99729496,
		        6.23777701,  2.13452525,  2.60346405,  3.66428708,  5.38186852,
		        2.81793201,  4.87238282,  4.64681441, 10.07184826,  4.12764913,
		        4.08650153,  3.92582103,  3.57261762,  7.0183008 ,  7.42508043,
		        5.61909492,  4.36365597,  4.45501703,  5.68125836,  9.58888785,
		        4.57702201,  1.59934367,  7.43400733,  2.43857994,  2.89786267,
		        5.21611877,  3.07463279,  3.5966073 ,  5.82580597,  3.29111512,
		        7.71218333,  3.65457626,  3.41419259,  3.46872823,  3.97169466,
		        5.87255824,  4.93899951,  5.59097718,  5.159097  ,  4.72360048,
		        3.34315672,  4.3125288 ,  3.97156224,  3.75165208,  3.57487444,
		        5.39066956,  7.04629458,  5.05313495,  2.45627447,  8.77055594,
		        6.59836241,  3.59258302,  5.13841405,  4.00035315,  4.01980826,
		        8.23425987,  3.22432386,  4.00921467,  6.15073955,  4.25859565,
		        3.28723237,  5.6736651 ,  3.69386313,  8.37681724,  8.47094948,
		        3.02416369,  2.80353699,  4.95325557,  4.00345662,  4.43281624,
		        5.08910372,  9.48723405,  9.6624806 ,  8.31384881,  5.00000249,
		        4.58075487,  5.07498183,  4.36951071,  6.71659942,  4.28643175,
		        6.22051627,  2.65344078,  5.97707238,  6.13729674,  4.82572196,
		        3.25874956,  5.72715613,  5.7371952 ,  8.14084317,  4.14166462,
		        4.58969582,  5.26973689,  3.82392295,  1.78632317, 10.70147768,
		        2.49135297,  4.68703457,  8.0709127 ,  3.98049474, 11.53519503,
		        4.73976316,  7.51924588,  3.75597856,  6.37124872,  3.36846789,
		        4.29106596,  8.31996871,  5.66379142,  5.90510432,  3.07981455,
		        2.07414688,  4.39670555,  5.98435189,  3.29925633,  1.03329932,
		        3.95751084,  2.37849831,  4.09947375,  7.55100545,  2.88850067,
		        6.16511398,  4.86710861,  3.96254372,  3.69236706,  5.80850025,
		        7.24345273,  8.19032362,  4.22693749,  4.77254766,  5.25254467,
		        3.03591541,  7.44992966,  5.22835837,  4.2796486 ,  2.44220817,
		        5.79346543,  4.69726878,  5.32503196,  3.32618179,  4.69994673,
		        3.79332308,  2.65351972,  5.29025219,  6.34495527,  4.58255061,
		        1.86577873,  2.95705727,  7.64851886,  4.94844155,  3.43668204,
		        4.50583533,  3.0765562 ,  5.10634881,  5.88145121,  4.47597415,
		        2.62195895,  5.98414399,  4.07769117,  5.86118012,  4.4903019 ,
		        6.41888257,  5.4079766 ,  7.45162511,  6.55508809,  1.50516429,
		        4.56636399,  3.180148  ,  7.30490201,  5.96185563,  7.29336095,
		        4.74382212,  7.09774673,  5.19211048,  3.05181678,  9.28497229,
		        3.99072453,  6.56089598,  8.83245162,  5.61015914,  5.87706683,
		        3.73233179,  4.41185878,  3.31217906,  5.36161769,  7.47378357,
		        4.55209673,  2.07996248,  3.69874347,  3.32488536,  3.70716872,
		        8.19144231,  5.27832512,  5.53912505, 14.67528993,  9.06160569,
		        5.22243625,  5.36882026,  7.36012059,  2.54688754,  5.86163172,
		        3.46948043,  3.29194077,  6.32900803,  3.2636159 ,  8.21395919,
		        6.51639667,  7.69520537,  5.23939157,  2.97348841,  4.67779008,
		        4.67034087,  5.64775727,  5.20703094,  6.75705631,  4.30362857,
		        4.61346966,  6.70430398,  5.28374781, 10.32969329,  5.09806886,
		        2.85715582,  4.18529444,  6.70939662,  4.84827228,  2.98300675,
		        2.61622282,  5.28374428,  3.3046985 ,  3.14107682,  3.65383798,
		        8.49222262,  7.10635161,  5.46018541,  3.05806802,  6.90070533,
		        3.35721022,  3.3849299 ,  4.7060661 ,  3.90905133,  8.29311303,
		        3.30470841,  9.46699116,  1.92966921,  6.52493171,  5.09032168,
		        8.25094761,  2.28679742,  5.40908049,  4.09024627,  3.04023238,
		        4.54272283,  5.0514348 ,  1.95071578,  3.42907065,  7.46028281,
		        5.32382941,  8.90603099,  8.69750325,  7.11865646,  2.65174015,
		        5.32739141,  6.76595085,  3.6088775 ,  2.77762308,  3.49891376,
		        3.35614498,  4.07313829,  2.80563904,  4.24867164,  4.99131247,
		        5.93307277,  6.08844684,  4.34593612,  6.6584574 ,  1.91868793,
		        2.86338449,  2.88881777,  3.84735135,  3.28571703,  3.25237956,
		        3.35185458,  4.86727255,  4.90718823,  6.58058251,  3.63623339,
		        7.54249369,  7.09405752,  5.26276785,  2.53825055,  4.46780537,
		        7.10465836,  5.92342978,  5.17572451,  3.34348303,  5.5468754 ,
		        6.5820138 ,  6.01254671,  4.85693399,  6.73431074,  1.83875091,
		        2.32988706,  5.42293612,  3.92184174,  1.7123644 ,  1.47999753,
		        4.14334565,  4.07608022,  6.89347588,  5.75752002,  2.33950024,
		        3.75754406,  1.86995572,  2.32118768,  2.37507783,  5.65671125,
		        6.53433951,  4.79775306,  7.9807641 ,  4.49805358,  5.01814952,
		        4.94287358, 10.47364845,  5.40357556,  2.83479407,  4.1594359 ,
		        9.58026383,  7.51754205,  4.99931874,  3.89742016,  2.96141555,
		       10.41005473,  5.73180999,  4.94336764,  5.25169331,  5.42929446,
		        3.07138699,  8.30910247,  5.10988046,  4.17105301,  3.5249456 ,
		        2.99471541,  4.29337321,  2.88563182,  4.40286933,  4.39555426,
		        6.41857541,  4.3529228 ,  3.03722211,  6.42558015,  9.00604842,
		        4.45367765,  3.21784403,  9.01214758,  4.59543379,  3.24236041,
		        4.19602012,  5.97498828,  3.81007715,  4.03996863,  2.70778551,
		        3.97739041,  3.36023893,  6.59817191,  4.35704674,  1.45131546,
		        3.3525069 ,  4.34810491,  5.20655292,  3.24346188,  3.27164804,
		        7.48655574,  4.20820378,  4.42537031,  3.38533104,  5.25956255,
		        9.92167294,  2.93363087,  3.51347089,  3.65914163,  2.51990529,
		        3.09934316,  6.55156714,  2.83581095,  6.55257066,  5.10006357,
		        5.74221536,  4.95996136,  5.32005111,  4.76373415,  5.63234291,
		        5.14423679,  2.91621593,  3.9977236 ,  4.94948096,  3.28110013,
		        8.10920855,  6.92461823,  5.57892643,  4.05240435,  2.65040648,
		        5.32808321,  3.20229539,  3.52156853,  7.41344262,  4.38430636,
		        6.89166635,  6.9595178 ,  3.76406161,  5.48130324,  3.07005685,
		        2.27050602,  8.36951911,  4.3267806 , 11.06584876,  6.8975275 ,
		        5.12645556,  4.15755464,  4.57601175,  7.1965793 ,  6.17966459,
		        5.74108966,  2.23825681,  3.17312709,  3.89178785,  5.47817804,
		        3.53657877,  9.99090713,  5.33252501,  7.56549247,  3.70791217,
		        4.71154532,  6.63841053,  5.36675084,  2.56719155,  8.83384776,
		        6.35531259,  2.85973702,  3.992489  ,  4.07901898,  2.36815962,
		        4.56872622,  7.43896368,  4.75586582,  4.2162287 ,  3.26010938,
		        7.03166541,  5.16109588,  3.13332566,  3.47634087,  9.08662924,
		        5.94512636,  4.4965626 ,  6.73203407,  4.07040859,  6.16301018,
		        1.62687351,  5.58479022,  8.32152692,  2.33216681,  6.35968112,
		       12.35724779,  7.16793775,  2.07672348,  5.61504417,  1.40357109,
		        4.85114356,  5.78852937,  4.40480566,  9.7875141 ,  7.24430287,
		        1.98728154,  5.70628705,  2.88116617,  1.91889357,  5.55361209,
		        5.80570462,  2.39293657,  5.87245025,  7.49266512,  5.86985601,
		        2.65861755,  5.97109861,  2.7053951 ,  5.18361239,  8.22125182,
		        4.43283478,  4.05690642,  7.62634201,  2.10736776,  4.69271341,
		        5.24952159,  8.85674471,  3.41623169,  7.53874173,  6.54417465,
		        1.78476944,  6.3558645 ,  4.18364161,  4.14659284, 10.1350538 ,
		        5.45110864,  2.51435686,  1.67399475,  2.59488602,  6.94953974,
		        4.02398875,  6.67725665,  3.20229223,  3.40803111,  2.98261048,
		        7.68723008,  2.37109821,  6.68061954,  4.33085358,  5.66183906,
		        4.61345194,  4.56420779,  5.26084286,  7.72582944,  4.11838183,
		        7.61547696,  4.77852453,  4.68823612,  3.88316767,  3.57215524,
		        9.34207737,  5.89620979,  8.71793449,  3.22518497,  8.58478372,
		        7.55537623,  6.78373933,  4.75878461,  2.7855224 ,  4.04814595,
		        9.69916661,  6.0376023 ,  6.69429949,  4.06681019,  4.4932905 ,
		        2.5263497 ,  5.00691567,  7.49144978,  4.18044392, 10.06033079,
		        5.88055315,  3.3580455 ,  1.7998268 ,  9.72355108,  3.82017657,
		        5.37079322,  5.73639301,  7.65204048,  6.9974006 ,  4.1998023 ,
		        7.13779696,  3.98448986,  3.61746559,  1.37832169,  3.88312934,
		        3.9621229 ,  6.49384279,  4.41743006,  2.31893548,  4.16604968,
		        1.46617817,  2.41421575,  1.43398253,  2.86250896,  3.89597989,
		       10.02617828,  5.03619512,  5.89157123,  6.07242186,  3.00057533,
		        8.90908178,  6.51126042,  5.57363422,  5.34235232,  5.44402946,
		        4.84718776,  5.91253148,  2.70156114,  4.84177615,  6.16754607,
		        5.41378341,  3.98002036,  2.8917592 ,  6.63206372,  4.09958349,
		        3.86971088,  3.91905799,  5.56254857,  8.88229029,  5.2236853 ,
		        2.89717545,  5.72399819,  8.58494404,  5.99058674,  3.55371063,
		        3.05825808,  5.82374954,  7.06791518,  1.83694061,  3.55410395,
		        2.61832496,  3.32733812,  4.15832904,  6.69076385,  6.49133578,
		        4.73361828,  7.41767844,  4.10815045,  3.5796995 ,  2.57625597,
		        6.76479471,  6.83074856,  2.94581967,  5.10936893,  4.17452691,
		        4.75110038,  4.08854221,  7.2486368 ,  1.17929074,  5.07430731,
		        2.12553589,  5.67663231,  5.8855547 ,  8.85034076,  6.08863061,
		        2.61483294,  4.20457633,  5.05261586,  5.49171365,  7.3045709 ,
		        8.10510369,  6.39814627,  3.05940079,  6.63919714,  4.28429674,
		        2.98799642,  2.64566832,  2.17387771,  1.83522457,  1.80149902,
		        5.80598097,  6.93357841,  5.44823566,  3.61930104,  3.77937419,
		        2.21463204,  7.18971895,  4.85694729,  7.02006753,  4.24773153,
		        4.08584994,  4.37375314,  6.05106332, 10.86490867,  6.90684296,
		        7.59900257,  4.18595393,  3.38502271,  8.73736935,  3.90115196,
		        8.09206288,  2.64685046,  1.45291746,  4.73238464,  1.9075448 ,
		        3.1384087 ,  2.98096579,  4.60541345,  8.35022519,  6.00205465,
		        3.77006664,  6.67494226,  3.54233899,  7.60989994, 12.22419648,
		        4.96703029,  4.81938726,  3.88918369,  9.70500093,  6.37270372,
		        7.95446305,  3.98731799,  4.59412876,  2.19125305,  6.26312323,
		        7.76510993,  2.00294753,  3.53874025,  4.33669485,  7.91652575,
		        2.221376  ,  4.80841408,  9.21388499,  4.80542662,  4.0584393 ,
		        1.95009862,  6.51771202,  9.16038493,  5.0366239 ,  0.91837226,
		        3.20802662,  7.9327959 ,  6.13604619, 11.84998349,  7.44536116,
		        1.03316918,  5.50355828,  6.85538696,  3.37353641,  5.04251924,
		        4.48153673, 12.00574593,  5.94800282,  7.04442437,  7.54834917,
		        6.55930811,  4.68838968,  3.39992064,  3.08522747,  5.29271748,
		        5.38364183,  8.4915884 ,  3.80675836,  7.0693878 ,  9.53189991,
		        7.25200693,  4.42248607,  2.11146713,  2.3279475 ,  4.59918694,
		        2.77726641,  5.85534082,  7.33726683,  7.9232052 ,  7.72615354,
		        4.679028  ,  1.79425154,  6.77590177,  6.62877883,  6.15600697,
		        4.20478625,  6.51605647,  5.75755104,  8.45051149,  3.13739826,
		        4.51078965,  4.36920083,  6.19626017,  6.69577999,  5.40483106,
		        6.88883402,  5.5812018 ,  6.74678942,  4.39244892,  6.09980954,
		        3.82782415,  6.03410673,  7.53055381,  4.12644176,  9.2146978 ,
		        5.27131723,  3.58512453,  5.57227669,  3.31914379,  6.64684465,
		        4.79271317,  9.02949431,  5.44913439,  4.97706005,  4.80127023,
		        0.74582969,  6.95479214,  1.22479472,  5.67827812,  4.02337526,
		        9.12668181,  4.35032889,  4.67089254,  6.39528934,  6.77850441,
		        4.29254831,  1.52944067,  3.81995744,  4.96547992,  5.73466413,
		        3.52193945,  2.65573659,  5.96740408,  4.54833305,  5.07087505,
		        2.91799845,  5.65719875,  3.64319252,  4.4989215 ,  3.98836803,
		        2.6300658 ,  3.01206646,  5.42389352,  8.36469851,  7.46415906,
		        2.25073645,  5.81133214,  2.5305667 ,  6.16978704,  4.37629645,
		        7.12647787,  2.18605018,  4.96111665,  4.9639635 ,  5.29273396,
		        8.83115579,  4.37867563,  6.87507252,  3.19485078,  3.56647001,
		        3.09205863,  5.90288861,  4.28485074,  3.21218713,  3.48271986,
		        3.05228949,  2.49902664,  2.3432168 ,  2.82351818,  5.03644923};
		
		EMHyperErlangFit fitter = new EMHyperErlangFit(data);
		//EMPhaseFit fitter = new EMPhaseFit(data);
		
		ContPhaseVar v1 = fitter.fit(9);
		System.out.println(v1);
		System.out.println("Termine fitting");
		System.out.println(v1.description());
		v1.getVectorArray();
		System.out.println(fitter.getLogLikelihood());
		
		
		System.out.println(data[0]);
		MomentsACPHFit fitter = new MomentsACPHFit ( 369.0,2026.403716386203, 317.05249448207906) ;
		ContPhaseVar v1 = fitter.fit();
		System.out.println(( "v1 : n n"+v1.toString ( )));
		System.out.println("m1: \t " + v1 .moment(1) );
		System.out.println("m1: \t " + v1 .moment(2) );
		System.out.println("m1: \t " + v1 .moment(3) );
		**/
		
		
		
		/**
		MomentsACPHFit fitter2 = new MomentsACPHFit(2,6,25);
		ContPhaseVar v2=fitter2.fit();
		System.out.println(v2.toString());
		
		double [][] T=v1.getMatrixArray();
		no.uib.cipr.matrix.Vector al= v1.getVector(); 
		
		System.out.println(v1.description());
		System.out.println(Arrays.deepToString(T));
		System.out.println(al.toString());
		
		System.out.println("termine");
		**/
	}

	public static void fit (double [][] data){
		
	}
}

